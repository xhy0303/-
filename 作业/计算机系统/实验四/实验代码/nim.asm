	.ORIG x3000
	AND R1,R1,#0
	ADD R1,R1,#3
	AND R2,R2,#0
	ADD R2,R2,#5
	AND R3,R3,#0
	ADD R3,R3,#8

	JSR CONTO
	JSR OUTPUT;初始化列表
MOVE	JSR ALERT1;玩家1操作
	JSR CONTO
	ADD R4,R4,#0
	BRz DONE1
	JSR OUTPUT
	JSR ALERT2;玩家2操作
	JSR CONTO
	ADD R4,R4,#0
	BRz DONE2
	JSR OUTPUT
	BRnp MOVE
DONE1
	LEA R0,ESign1
	PUTS
	BRnzp DONE	
DONE2	
	LEA R0,ESign2
	PUTS
	BRnzp DONE
DONE	
	HALT

ESign1	.STRINGZ	"Player 1 Wins."
ESign2	.STRINGZ	"Player 2 Wins."

JUDGE	ST R7,SAR7_J
	GETC
	OUT
	NOT R0,R0
	ADD R0,R0,#1
GET_A	LD R7,A
	ADD R7,R7,R0
	BRnp GET_B
	BRz GETN_A
GET_B	LD R7,B
	ADD R7,R7,R0
	BRnp GET_C
	BRz GETN_B
GET_C	LD R7,C
	ADD R7,R7,R0
	BRnp wGETN
	BRz GETN_C
wGETN	GETC
	OUT
	LD R0,ENTER_J
	OUT
SHOW	LEA R0,WSign
	PUTS
	LD R0,ENTER_J
	OUT
	ADD R6,R6,#0
	BRz Loop1
	BRnp Loop2
GETN_A	GETC
	OUT
	ST R0,SAR0_J
	LD R0,ENTER_J
	OUT
	LD R0,SAR0_J
	LD R7,ASCII
	NOT R7,R7
	ADD R7,R7,#1
	ADD R0,R0,R7
	BRn SHOW
	NOT R0,R0
	ADD R0,R0,#1
	ADD R7,R1,R0
	BRn SHOW
	ADD R1,R1,R0
	BRnzp DONE_J
GETN_B	GETC
	OUT
	ST R0,SAR0_J
	LD R0,ENTER_J
	OUT
	LD R0,SAR0_J
	LD R7,ASCII
	NOT R7,R7
	ADD R7,R7,#1
	ADD R0,R0,R7
	BRn SHOW
	NOT R0,R0
	ADD R0,R0,#1
	ADD R7,R2,R0
	BRn SHOW
	ADD R2,R2,R0
	BRnzp DONE_J
GETN_C	GETC
	OUT
	ST R0,SAR0_J
	LD R0,ENTER_J
	OUT
	LD R0,SAR0_J
	LD R7,ASCII
	NOT R7,R7
	ADD R7,R7,#1
	ADD R0,R0,R7
	BRn SHOW
	NOT R0,R0
	ADD R0,R0,#1
	ADD R7,R3,R0
	BRn SHOW
	ADD R3,R3,R0
	BRnzp DONE_J
	
DONE_J	LD R7,SAR7_J
	RET
SAR7_J	.BLKW	1
SAR0_J	.BLKW	1
WSign	.STRINGZ	"Invalid move. Try again."
A	.FILL	x41
B	.FILL	x42
C	.FILL	x43
ASCII	.FILL	x30
ENTER_J	.FILL	x0A

CONTO;R4所有石子计数器
	ST R7,SAR7_C
	ADD R4,R1,R2
	ADD R4,R4,R3
	LD R7,SAR7_C
	RET
SAR7_C	.BLKW 1

ALERT1
	ST R7,SAR71
Loop1	LEA R0,Sign1
	PUTS
	AND R6,R6,#0
	JSR JUDGE
	;AND R6,R6,#-1
	;BRz Loop1
	LD R0,ENTER_1
	OUT
	
	LD R7,SAR71
	RET
Sign1	.STRINGZ	"Player 1,choose a row and number of rocks:"
SAR71	.BLKW	1
ENTER_1	.FILL	x0A


ALERT2
	ST R7,SAR72
Loop2	LEA R0,Sign2
	PUTS
	AND R6,R6,#0
	ADD R6,R6,#1
	JSR JUDGE
	;AND R6,R6,#-1
	;BRz Loop1
	LD R0,ENTER_2
	OUT
	
	LD R7,SAR72
	RET
Sign2	.STRINGZ	"Player 2,choose a row and number of rocks:"
SAR72	.BLKW	1
ENTER_2	.FILL	x0A


OUTPUT	;R1，2，3分别为ABC的计数器，输出游戏界面
	ST R7,SAR7I
	ST R4,SAR4I
	LEA R0,SIGN_A
	PUTS
	ADD R4,R1,#0
	BRnz B_O
LOOP1	LD R0,o
	OUT
	ADD R4,R4,#-1
	BRp LOOP1
B_O	LD R0,ENTER_I
	OUT
	LEA R0,SIGN_B
	PUTS
	ADD R4,R2,#0
	BRnz C_O
LOOP2	LD R0,o
	OUT
	ADD R4,R4,#-1
	BRp LOOP2
C_O	LD R0,ENTER_I
	OUT
	LEA R0,SIGN_C
	PUTS
	ADD R4,R3,#0
	BRnz DONE_O
LOOP3	LD R0,o
	OUT
	ADD R4,R4,#-1
	BRp LOOP3
DONE_O	LD R0,ENTER_I
	OUT
	LD R4,SAR4I
	LD R7,SAR7I
	RET
SIGN_A	.STRINGZ "ROW A: "
SIGN_B	.STRINGZ "ROW B: "
SIGN_C	.STRINGZ "ROW C: "
o	.FILL	x6F
ENTER_I	.FILL	x0A
SAR7I	.BLKW	1
SAR4I	.BLKW	1
	
	.end